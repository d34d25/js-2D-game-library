"use strict";const t=function(){let t=performance.now(),e=0,o=0;const a=Object.assign(document.createElement("div"),{style:"position:fixed;top:10px;left:10px;background:#000;color:#0f0;padding:4px;font:12px monospace;z-index:9999"});return document.body.appendChild(a),function(){const i=performance.now();e++,i-t>=1e3&&(o=e,e=0,t=i),a.textContent="FPS: "+o}}();exports.Camera=class{constructor({position:t={x:0,y:0},scale:e=1,rotation:o=0}){this.position=t,this.scale=e,this.rotation=o}drawWithCamera({ctx:t,canvas:e,drawScene:o}){t.save(),t.clearRect(0,0,e.width,e.height),t.translate(e.width/2,e.height/2),t.rotate(this.rotation),t.scale(this.scale,this.scale),t.translate(-this.position.x-e.width/2/this.scale,-this.position.y-e.height/2/this.scale),o(),t.restore()}},exports.CircularLigth=class{constructor({position:t={x:0,y:0},radius:e=10,intensity:o=1,color:a={r:255,g:200,b:100,a:.2}}){this.position=t,this.radius=e,this.intensity=o,this.color=a}},exports.ConeLight=class{constructor({position:t={x:0,y:0},angle:e=0,spread:o=6,length:a=100,intensity:i=1,color:l={r:255,g:200,b:100,a:.2}}){this.position=t,this.angle=e,this.spread=Math.PI/o,this.length=a,this.intensity=i,this.color=l}},exports.cropImage=function(t,e,o){if(!t.loaded)return console.warn("Image not loaded yet!"),[];const a=[],i=t.img.width,l=t.img.height,n=Math.ceil(i/e),r=Math.ceil(l/o);for(let i=0;i<r;i++)for(let l=0;l<n;l++)a.push({sx:l*e,sy:i*o,sWidth:e,sHeight:o,draw({ctx:e,dx:o=0,dy:a=0,scaleX:i=1,scaleY:l=1,rotationRadians:n=0,alpha:r=1,flipHorizontally:s=!1,flipVertically:h=!1}){if(!t.loaded)return;e.globalAlpha=r,e.imageSmoothingEnabled=!1;const c=s?-1:1,d=h?-1:1,g=this.sWidth*i,p=this.sHeight*l;e.save(),e.translate(o+g/2,a+p/2),e.rotate(n),e.scale(c,d),e.drawImage(t.img,this.sx,this.sy,this.sWidth,this.sHeight,-g/2,-p/2,g,p),e.restore(),e.globalAlpha=1}});return a},exports.drawAABBOutline=function(t,e,o="red",a=1){t.strokeStyle=o,t.lineWidth=a;const i=e.maxX-e.minX,l=e.maxY-e.minY;t.strokeRect(e.minX,e.minY,i,l)},exports.drawCircle=function({ctx:t,point:e={x:0,y:0},color:o="pink",radius:a=15,rotation:i=0,rotationIndicator:l=!1,alpha:n=1}){t.globalAlpha=n,t.strokeStyle="black",t.save(),t.translate(e.x,e.y),t.rotate(i),t.beginPath(),t.arc(0,0,a,0,2*Math.PI),t.fillStyle=o,t.fill(),t.stroke(),l&&(t.beginPath(),t.moveTo(0,0),t.lineTo(a,0),t.lineWidth=2,t.stroke()),t.restore(),t.globalAlpha=1},exports.drawCircleOutline=function({ctx:t,point:e={x:0,y:0},color:o="pink",radius:a=15,rotation:i=0,rotationIndicator:l=!1,alpha:n=1}){if(t.globalAlpha=n,t.strokeStyle="black",t.beginPath(),t.arc(e.x,e.y,a,0,2*Math.PI),t.strokeStyle=o,t.lineWidth=2,t.stroke(),l){const l=.7*a,n=e.x+Math.cos(i)*l,r=e.y+Math.sin(i)*l;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n,r),t.strokeStyle=o,t.lineWidth=2,t.stroke()}t.globalAlpha=1},exports.drawFPS=t,exports.drawGradientCircle=function({ctx:t,x:e=0,y:o=0,radius:a=50,innerColor:i="rgba(255, 255, 255, 1)",outerColor:l="rgba(51, 255, 0, 0)"}){const n=t.createRadialGradient(e,o,0,e,o,a);n.addColorStop(0,i),n.addColorStop(1,l),t.fillStyle=n,t.beginPath(),t.arc(e,o,a,0,2*Math.PI),t.fill()},exports.drawGradientTriangle=function({ctx:t,x:e=0,y:o=0,width:a=100,height:i=100,topColor:l="rgba(255, 255, 255, 1)",baseColor:n="rgba(229, 255, 0, 0)",rotation:r=0}){const s=e+a/2,h=o+i/2;t.save(),t.translate(s,h),t.rotate(r),t.translate(-s,-h);const c=e+a/2,d=o,g=e,p=o+i,f=e+a,x=o+i,y=(g+f)/2,b=(p+x)/2,u=t.createLinearGradient(c,d,y,b);u.addColorStop(0,l),u.addColorStop(1,n),t.fillStyle=u,t.beginPath(),t.moveTo(c,d),t.lineTo(g,p),t.lineTo(f,x),t.closePath(),t.fill(),t.restore()},exports.drawPolygon=function({ctx:t,vertices:e,fillStyle:o="blue",alpha:a=1}){if(t.globalAlpha=a,t.strokeStyle="black",!(e.length<2)){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(let o=1;o<e.length;o++)t.lineTo(e[o].x,e[o].y);t.closePath(),t.fillStyle=o,t.fill(),t.stroke(),t.globalAlpha=1}},exports.drawPolygonOutline=function({ctx:t,vertices:e,strokeStyle:o="blue",lineWidth:a=2,alpha:i=1}){if(t.globalAlpha=i,t.strokeStyle="black",e&&!(e.length<2)){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(let o=1;o<e.length;o++)t.lineTo(e[o].x,e[o].y);t.closePath(),t.strokeStyle=o,t.lineWidth=a,t.stroke(),t.globalAlpha=1}},exports.drawRectangle=function({ctx:t,x:e=0,y:o=0,width:a=10,height:i=10,color:l="black",rotation:n=0,alpha:r=1}){t.globalAlpha=r,t.fillStyle=l,t.save(),t.translate(e+a/2,o+i/2),t.rotate(n),t.fillRect(-a/2,-i/2,a,i),t.restore(),t.globalAlpha=1},exports.drawTriangle=function({ctx:t,x:e=0,y:o=0,width:a=100,height:i=100,color:l="green",rotation:n=0}){const r=e+a/2,s=o+i/2;t.save(),t.translate(r,s),t.rotate(n),t.translate(-r,-s);const h=e+a/2,c=o,d=e,g=o+i,p=e+a,f=o+i;t.fillStyle=l,t.beginPath(),t.moveTo(h,c),t.lineTo(d,g),t.lineTo(p,f),t.closePath(),t.fill(),t.restore()},exports.loadImageLazy=function(t){const e=new Image;let o=!1;const a=[];return e.onload=()=>{o=!0,a.forEach(t=>t())},e.src=t,{img:e,get loaded(){return o},onLoad(t){o?t():a.push(t)},draw({ctx:t,x:a=0,y:i=0,scaleX:l=1,scaleY:n=1,rotationRadians:r=0,alpha:s=1,flipHorizontally:h=!1,flipVertically:c=!1}){if(o){t.globalAlpha=s,t.imageSmoothingEnabled=!1;const o=h?-1:1,d=c?-1:1,g=e.width*l,p=e.height*n;t.save(),t.translate(a+g/2,i+p/2),t.rotate(r),t.scale(o,d),t.drawImage(e,-g/2,-p/2,g,p),t.restore(),t.globalAlpha=1}}}},exports.playAnimation=function({spriteArray:t=[],startFrame:e=0,endFrame:o=1,animationSpeed:a=1,elapsedTime:i=0}){if(0===t.length)return null;const l=o-e+1,n=1/a;return t[e+Math.floor(i/n)%l]},exports.setDarkOverlayUnified=function({ctx:t,width:e=800,height:o=600,color:a="rgba(0, 0, 0, 1)",lights:i=[],hasColor:l=!0,x:n=-200,y:r=-200}){const s=document.createElement("canvas");s.width=e,s.height=o;const h=s.getContext("2d");h.fillStyle=a,h.fillRect(0,0,e,o),h.globalCompositeOperation="destination-out",i.forEach(e=>{const{position:o,intensity:a,color:i}=e,{x:s,y:c}=o,d=s-n,g=c-r;if("radius"in e){const{radius:o}=e;l&&(t.fillStyle=`rgba(${i.r}, ${i.g}, ${i.b}, ${.3*a})`,t.beginPath(),t.arc(s,c,o,0,2*Math.PI),t.fill());const n=h.createRadialGradient(d,g,0,d,g,o);n.addColorStop(0,`rgba(0, 0, 0, ${a})`),n.addColorStop(1,"rgba(0, 0, 0, 0)"),h.fillStyle=n,h.beginPath(),h.arc(d,g,o,0,2*Math.PI),h.fill()}else if("angle"in e&&"spread"in e&&"length"in e){const{angle:o,spread:n,length:r}=e,p=d+Math.cos(o-n/2)*r,f=g+Math.sin(o-n/2)*r,x=d+Math.cos(o+n/2)*r,y=g+Math.sin(o+n/2)*r,b=h.createLinearGradient(d,g,d+Math.cos(o)*r,g+Math.sin(o)*r);b.addColorStop(0,`rgba(0, 0, 0, ${a})`),b.addColorStop(1,"rgba(0, 0, 0, 0)"),h.fillStyle=b,h.beginPath(),h.moveTo(d,g),h.lineTo(p,f),h.lineTo(x,y),h.closePath(),h.fill(),l&&(t.fillStyle=`rgba(${i.r}, ${i.g}, ${i.b}, ${.3*a})`,t.beginPath(),t.moveTo(s,c),t.lineTo(s+Math.cos(o-n/2)*r,c+Math.sin(o-n/2)*r),t.lineTo(s+Math.cos(o+n/2)*r,c+Math.sin(o+n/2)*r),t.closePath(),t.fill())}}),t.globalCompositeOperation="source-over",t.drawImage(s,n,r)};
